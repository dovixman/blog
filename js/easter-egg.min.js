(function(){"use strict";const s=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768,n=new Map,t={HIDDEN:"hidden",IDLE:"idle",RUNNING:"running",PANIC:"panic",JUMPING:"jumping",CLIMBING:"climbing",EXPLODING:"exploding"},e={active:!1,isMobile:s,chaosMode:!1,state:t.HIDDEN,stickMan:null,mouseX:0,mouseY:0,touchX:0,touchY:0,stickManX:0,stickManY:0,velocityX:0,velocityY:0,isJumping:!1,isClimbing:!1,jumpStartY:0,climbProgress:0,climbTarget:null,speed:s?6:4,panicSpeed:s?10:8,panicDistance:200,jumpDistance:120,animationFrame:null,obstacles:[],lastObstacleUpdate:0,stateChangeTime:0,minStateTime:300,lastJumpTime:0,jumpCooldown:1e3,lastDirectionChange:0,directionChangeInterval:2e3,targetX:0,targetY:0,kickForce:15,kickDistance:60,stuckCounter:0,lastPositions:[],positionHistorySize:10,isGhosting:!1,ghostingEndTime:0,lastUnstuckTime:0,unstuckCooldown:2e3},D=.5,a=.6,p=.98,j=5,b={easeOutQuad:e=>e*(2-e),easeInOutQuad:e=>e<.5?2*e*e:-1+(4-2*e)*e,easeOutCubic:e=>--e*e*e+1};function l(){x(),u(),s?(document.addEventListener("touchstart",m),document.addEventListener("touchmove",m)):document.addEventListener("mousemove",R),e.stickMan.addEventListener("click",f),s&&e.stickMan.addEventListener("touchstart",f),window.addEventListener("resize",()=>{e.active&&c()});let t;window.addEventListener("scroll",()=>{if(!e.active)return;clearTimeout(t),t=setTimeout(c,100)})}function x(){const t=document.createElement("div");t.id="stick-man",t.innerHTML=`
      <div class="stick-man-body">
        <div class="stick-man-head"></div>
        <div class="stick-man-torso"></div>
        <div class="stick-man-arm left"></div>
        <div class="stick-man-arm right"></div>
        <div class="stick-man-leg left"></div>
        <div class="stick-man-leg right"></div>
      </div>
    `,document.body.appendChild(t),e.stickMan=t}function u(){const s=[{x:-15,y:-20,name:"top-left"},{x:window.innerWidth-35,y:-20,name:"top-right"},{x:-15,y:window.innerHeight-60,name:"bottom-left"},{x:window.innerWidth-35,y:window.innerHeight-60,name:"bottom-right"}],n=s[Math.floor(Math.random()*s.length)];e.stickManX=n.x,e.stickManY=n.y,e.stickMan.style.left=n.x+"px",e.stickMan.style.top=n.y+"px",e.stickMan.classList.add("active","hidden-trigger","idle"),e.state=t.HIDDEN}function R(t){e.mouseX=t.clientX,e.mouseY=t.clientY}function m(t){t.touches.length>0&&(e.touchX=t.touches[0].clientX,e.touchY=t.touches[0].clientY,e.mouseX=e.touchX,e.mouseY=e.touchY)}function f(n){n.preventDefault(),n.stopPropagation(),e.state===t.HIDDEN?A():e.active&&e.state!==t.EXPLODING&&k()}function A(){e.active=!0,e.chaosMode=s,e.state=t.RUNNING,e.stateChangeTime=Date.now(),e.stickMan.classList.remove("hidden-trigger","idle"),e.stickMan.classList.add("running"),e.chaosMode&&(e.stickMan.classList.add("chaos"),i()),e.stickManX=window.innerWidth/2-25,e.stickManY=window.innerHeight/2-40,c(),h()}function k(){e.active=!1,e.state=t.EXPLODING,d(),e.stickMan.classList.add("exploding"),e.animationFrame&&(cancelAnimationFrame(e.animationFrame),e.animationFrame=null),setTimeout(()=>{e.stickMan.classList.remove("active","exploding"),e.velocityX=0,e.velocityY=0,e.isJumping=!1,e.isClimbing=!1,n.forEach((e,t)=>{t&&t.parentNode&&(t.style.transform="",t.style.position="",t.style.left="",t.style.top="",t.style.zIndex="")}),n.clear(),setTimeout(u,3e3)},600)}function d(){e.stickMan.classList.remove("idle","running","panic","jumping","climbing","flip","chaos")}function c(){const t=Date.now();if(t-e.lastObstacleUpdate<500)return;e.lastObstacleUpdate=t,e.obstacles=[];const n=["header","nav","footer","article",".post",".card",".home-profile",".home-avatar",".single-title",".content",".page",".pagination",".post-footer",".post-nav","h1","h2","h3","img",".button","p","a.menu-item"];n.forEach(t=>{const n=document.querySelectorAll(t);n.forEach(t=>{if(t.id==="stick-man"||t.closest("#stick-man"))return;const n=t.getBoundingClientRect();n.width>20&&n.height>20&&e.obstacles.push({element:t,left:n.left+window.scrollX,top:n.top+window.scrollY,right:n.right+window.scrollX,bottom:n.bottom+window.scrollY,width:n.width,height:n.height,centerX:n.left+n.width/2,centerY:n.top+n.height/2})})})}function i(){e.targetX=Math.random()*window.innerWidth,e.targetY=Math.random()*window.innerHeight,e.speed=3+Math.random()*5,e.lastDirectionChange=Date.now()}function y(){if(e.lastPositions.push({x:e.stickManX,y:e.stickManY}),e.lastPositions.length>e.positionHistorySize&&e.lastPositions.shift(),e.lastPositions.length<e.positionHistorySize)return!1;let t=0;for(let n=1;n<e.lastPositions.length;n++){const s=e.lastPositions[n].x-e.lastPositions[n-1].x,o=e.lastPositions[n].y-e.lastPositions[n-1].y;t+=(s*s+o*o)**.5}const n=t/(e.lastPositions.length-1);return n<.5}function _(){const t=[0,45,90,135,180,225,270,315],n=[100,150,200];for(let s of n)for(let a of t){const i=a*Math.PI/180,n=e.stickManX+Math.cos(i)*s,o=e.stickManY+Math.sin(i)*s;if(n<20||n>window.innerWidth-70||o<20||o>window.innerHeight-100)continue;if(!r(n,o,10))return{x:n,y:o}}return{x:100+Math.random()*(window.innerWidth-200),y:100+Math.random()*(window.innerHeight-200)}}function w(){const t=Date.now();if(t-e.lastUnstuckTime<e.unstuckCooldown)return;if(e.stuckCounter++,e.lastUnstuckTime=t,e.stuckCounter===1){const t=Math.random()*Math.PI*2,n=e.chaosMode?15:12;e.velocityX=Math.cos(t)*n,e.velocityY=Math.sin(t)*n,e.stickMan.style.animation="boost-burst 0.5s ease-out",setTimeout(()=>{e.stickMan.style.animation=""},500)}else if(e.stuckCounter===2){e.isGhosting=!0,e.ghostingEndTime=t+1500;const n=Math.random()*Math.PI*2,s=e.chaosMode?18:15;e.velocityX=Math.cos(n)*s,e.velocityY=Math.sin(n)*s,e.stickMan.style.opacity="0.6"}else{const t=_();e.stickMan.style.opacity="0",e.stickMan.style.transform="scale(0.5) rotate(180deg)",e.stickMan.style.filter="blur(5px)",setTimeout(()=>{e.stickManX=t.x,e.stickManY=t.y,e.velocityX=0,e.velocityY=0,e.stickMan.style.animation="teleport-flash 0.4s ease-out",e.stickMan.style.opacity="1",e.stickMan.style.transform="",e.stickMan.style.filter="",setTimeout(()=>{e.stickMan.style.animation=""},400)},150),e.stuckCounter=0,e.lastPositions=[]}}function O(){e.isGhosting&&Date.now()>e.ghostingEndTime&&(e.isGhosting=!1,e.stickMan.style.opacity="1",e.stuckCounter=0)}function g(){const s=Date.now();if(s-e.lastDirectionChange>e.directionChangeInterval)return!0;const t=e.stickManX-e.targetX,n=e.stickManY-e.targetY,o=(t*t+n*n)**.5;return o<50}function C(e,t,s){if(n.has(e))return;const o=e.getBoundingClientRect(),a={position:e.style.position,left:e.style.left,top:e.style.top,transform:e.style.transform,zIndex:e.style.zIndex},i={x:o.left,y:o.top,velX:t,velY:s,rotation:0,rotationVel:(Math.random()-.5)*j*2,width:o.width,height:o.height,originalStyles:a,grounded:!1};e.style.position="fixed",e.style.left=i.x+"px",e.style.top=i.y+"px",e.style.zIndex="9999",e.style.transition="none",n.set(e,i)}function E(){const e=[];n.forEach((t,n)=>{t.velY+=D,t.velX*=p,t.velY*=p,t.rotation+=t.rotationVel,t.x+=t.velX,t.y+=t.velY;const s=window.innerHeight;t.y+t.height>s&&(t.y=s-t.height,t.velY*=-a,t.rotationVel*=a,Math.abs(t.velY)<1&&Math.abs(t.velX)<1&&(t.grounded=!0)),t.x<-t.width/2&&(t.x=-t.width/2,t.velX*=-a),t.x>window.innerWidth-t.width/2&&(t.x=window.innerWidth-t.width/2,t.velX*=-a),n.style.left=t.x+"px",n.style.top=t.y+"px",n.style.transform=`rotate(${t.rotation}deg)`,t.y>window.innerHeight+500&&e.push(n)}),e.forEach(e=>{if(e&&e.parentNode){const t=n.get(e);t&&t.originalStyles&&(e.style.position=t.originalStyles.position,e.style.left=t.originalStyles.left,e.style.top=t.originalStyles.top,e.style.transform=t.originalStyles.transform,e.style.zIndex=t.originalStyles.zIndex)}n.delete(e)})}function v(){if(!e.chaosMode)return;const t={left:e.stickManX,top:e.stickManY,right:e.stickManX+50,bottom:e.stickManY+80,centerX:e.stickManX+25,centerY:e.stickManY+40};e.obstacles.forEach(s=>{if(n.has(s.element))return;if(t.right>s.left&&t.left<s.right&&t.bottom>s.top&&t.top<s.bottom){const o=s.centerX-t.centerX,i=s.centerY-t.centerY,n=(o*o+i*i)**.5;if(n>0&&n<e.kickDistance){const t=o/n*e.kickForce+e.velocityX*2,a=i/n*e.kickForce-5;C(s.element,t,a)}}})}function r(t,s,o=15){if(e.isGhosting)return null;const i={left:t-o,top:s-o,right:t+50+o,bottom:s+80+o,centerX:t+25,centerY:s+40};for(let t of e.obstacles){if(n.has(t.element))continue;if(i.right>t.left&&i.left<t.right&&i.bottom>t.top&&i.top<t.bottom)return t}return null}function S(t,n,s,o,i=150){let a=null,r=i;for(let i of e.obstacles){const c=i.centerX-(t+25),l=i.centerY-(n+40),d=(c*c+l*l)**.5;if(d<r){const e=(c*s+l*o)/d;e>.3&&(a=i,r=d)}}return a}function M(t){const n=Date.now();return!(n-e.lastJumpTime<e.jumpCooldown)&&!!t&&t.height<100&&t.height>30}function F(e){return!!e&&e.height>=100&&e.height<400}function T(){if(e.isJumping||e.isClimbing)return;e.isJumping=!0,e.jumpStartY=e.stickManY,e.lastJumpTime=Date.now(),o(t.JUMPING)}function z(n){if(e.isJumping||e.isClimbing)return;if(!n)return;e.isClimbing=!0,e.climbTarget=n,e.climbProgress=0,o(t.CLIMBING)}function o(n){if(e.state===n)return;const s=Date.now();if(s-e.stateChangeTime<e.minStateTime)return;switch(d(),e.state=n,e.stateChangeTime=s,n){case t.IDLE:e.stickMan.classList.add("idle");break;case t.RUNNING:e.stickMan.classList.add("running");break;case t.PANIC:e.stickMan.classList.add("panic","running");break;case t.JUMPING:e.stickMan.classList.add("jumping");break;case t.CLIMBING:e.stickMan.classList.add("climbing");break}}function N(){const a=e.stickManX+25-e.mouseX,c=e.stickManY+40-e.mouseY,n=(a*a+c*c)**.5,s=n<e.panicDistance,i=s?e.panicSpeed:e.speed;if(!e.isJumping&&!e.isClimbing&&(s&&e.state!==t.PANIC?o(t.PANIC):!s&&e.state===t.PANIC&&o(t.RUNNING)),e.isJumping){const i=500,a=Date.now()-e.lastJumpTime,n=Math.min(a/i,1);if(n>=1)e.isJumping=!1,o(s?t.PANIC:t.RUNNING);else{const s=80,t=n,o=-4*s*(t*t-t);e.stickManY=e.jumpStartY-o}}if(e.isClimbing&&e.climbTarget)if(e.climbProgress+=.015,e.climbProgress>=1)e.isClimbing=!1,e.stickManY=e.climbTarget.top-85,e.climbTarget=null,o(s?t.PANIC:t.RUNNING);else{const t=e.climbTarget.bottom,n=e.climbTarget.top-85;e.stickManY=t+(n-t)*b.easeInOutQuad(e.climbProgress);const s=a>0?e.climbTarget.right:e.climbTarget.left-50;e.stickManX+=(s-e.stickManX)*.1}if(!e.isJumping&&!e.isClimbing){if(n>0){const s=a/n,o=c/n;e.velocityX+=s*.8,e.velocityY+=o*.8,e.velocityX*=.85,e.velocityY*=.85;const t=(e.velocityX*e.velocityX+e.velocityY*e.velocityY)**.5;t>i&&(e.velocityX=e.velocityX/t*i,e.velocityY=e.velocityY/t*i)}let t=e.stickManX+e.velocityX,s=e.stickManY+e.velocityY;const u={x:e.velocityX/Math.max(Math.abs(e.velocityX),.1),y:e.velocityY/Math.max(Math.abs(e.velocityY),.1)},o=S(e.stickManX,e.stickManY,u.x,u.y,n<e.jumpDistance?100:150);o&&n<e.jumpDistance&&(M(o)?T():F(o)&&z(o));const d=r(t,s);if(d){const n=e.stickManX+25-d.centerX,o=e.stickManY+40-d.centerY,a=(n*n+o*o)**.5;if(a>0){const r=2;e.velocityX=n/a*i*r,e.velocityY=o/a*i*r,t=e.stickManX+e.velocityX*1.5,s=e.stickManY+e.velocityY*1.5}}const l=20;t<l&&(t=l,e.velocityX=Math.abs(e.velocityX)*.8),t>window.innerWidth-70&&(t=window.innerWidth-70,e.velocityX=-Math.abs(e.velocityX)*.8),s<l&&(s=l,e.velocityY=Math.abs(e.velocityY)*.8),s>window.innerHeight-100&&(s=window.innerHeight-100,e.velocityY=-Math.abs(e.velocityY)*.8),e.stickManX=t,e.stickManY=s,e.velocityX<-.5?e.stickMan.classList.add("flip"):e.velocityX>.5&&e.stickMan.classList.remove("flip")}}function L(){g()&&i();const o=e.targetX-(e.stickManX+25),a=e.targetY-(e.stickManY+40),c=(o*o+a*a)**.5;if(c>10){const n=o/c,s=a/c;e.velocityX+=n*.8,e.velocityY+=s*.8;const t=(e.velocityX*e.velocityX+e.velocityY*e.velocityY)**.5;t>e.speed&&(e.velocityX=e.velocityX/t*e.speed,e.velocityY=e.velocityY/t*e.speed)}Math.random()<.01&&e.stickMan.classList.toggle("panic");let t=e.stickManX+e.velocityX,n=e.stickManY+e.velocityY;const l=r(t,n);if(l){const s=e.stickManX+25-l.centerX,o=e.stickManY+40-l.centerY,i=(s*s+o*o)**.5;if(i>0){const a=2.5;e.velocityX=s/i*e.speed*a,e.velocityY=o/i*e.speed*a,t=e.stickManX+e.velocityX*1.5,n=e.stickManY+e.velocityY*1.5}}const s=10;t<s&&(t=s,e.velocityX=Math.abs(e.velocityX),i()),t>window.innerWidth-60&&(t=window.innerWidth-60,e.velocityX=-Math.abs(e.velocityX),i()),n<s&&(n=s,e.velocityY=Math.abs(e.velocityY),i()),n>window.innerHeight-90&&(n=window.innerHeight-90,e.velocityY=-Math.abs(e.velocityY),i()),e.stickManX=t,e.stickManY=n,e.velocityX<-.5?e.stickMan.classList.add("flip"):e.velocityX>.5&&e.stickMan.classList.remove("flip"),v()}function h(){if(!e.active)return;O(),y()&&w(),e.chaosMode?L():N(),e.chaosMode&&E(),e.stickMan.style.left=Math.round(e.stickManX)+"px",e.stickMan.style.top=Math.round(e.stickManY)+"px",e.animationFrame=requestAnimationFrame(h)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",l):l()})()