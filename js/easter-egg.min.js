(function(){"use strict";const t={HIDDEN:"hidden",IDLE:"idle",RUNNING:"running",PANIC:"panic",JUMPING:"jumping",CLIMBING:"climbing",EXPLODING:"exploding"},e={active:!1,state:t.HIDDEN,stickMan:null,mouseX:0,mouseY:0,stickManX:0,stickManY:0,velocityX:0,velocityY:0,isJumping:!1,isClimbing:!1,jumpStartY:0,climbProgress:0,climbTarget:null,speed:4,panicSpeed:8,panicDistance:200,jumpDistance:120,animationFrame:null,obstacles:[],lastObstacleUpdate:0,stateChangeTime:0,minStateTime:300,lastJumpTime:0,jumpCooldown:1e3},b={easeOutQuad:e=>e*(2-e),easeInOutQuad:e=>e<.5?2*e*e:-1+(4-2*e)*e,easeOutCubic:e=>--e*e*e+1};function i(){d(),r(),document.addEventListener("mousemove",y),e.stickMan.addEventListener("click",m),window.addEventListener("resize",()=>{e.active&&s()});let t;window.addEventListener("scroll",()=>{if(!e.active)return;clearTimeout(t),t=setTimeout(s,100)})}function d(){const t=document.createElement("div");t.id="stick-man",t.innerHTML=`
      <div class="stick-man-body">
        <div class="stick-man-head"></div>
        <div class="stick-man-torso"></div>
        <div class="stick-man-arm left"></div>
        <div class="stick-man-arm right"></div>
        <div class="stick-man-leg left"></div>
        <div class="stick-man-leg right"></div>
      </div>
    `,document.body.appendChild(t),e.stickMan=t}function r(){const s=[{x:-15,y:-20,name:"top-left"},{x:window.innerWidth-35,y:-20,name:"top-right"},{x:-15,y:window.innerHeight-60,name:"bottom-left"},{x:window.innerWidth-35,y:window.innerHeight-60,name:"bottom-right"}],n=s[Math.floor(Math.random()*s.length)];e.stickManX=n.x,e.stickManY=n.y,e.stickMan.style.left=n.x+"px",e.stickMan.style.top=n.y+"px",e.stickMan.classList.add("active","hidden-trigger","idle"),e.state=t.HIDDEN}function y(t){e.mouseX=t.clientX,e.mouseY=t.clientY}function m(n){n.stopPropagation(),e.state===t.HIDDEN?u():e.active&&e.state!==t.EXPLODING&&l()}function u(){e.active=!0,e.state=t.RUNNING,e.stateChangeTime=Date.now(),e.stickMan.classList.remove("hidden-trigger","idle"),e.stickMan.classList.add("running"),e.stickManX=window.innerWidth/2-25,e.stickManY=window.innerHeight/2-40,s(),a()}function l(){e.active=!1,e.state=t.EXPLODING,o(),e.stickMan.classList.add("exploding"),e.animationFrame&&(cancelAnimationFrame(e.animationFrame),e.animationFrame=null),setTimeout(()=>{e.stickMan.classList.remove("active","exploding"),e.velocityX=0,e.velocityY=0,e.isJumping=!1,e.isClimbing=!1,setTimeout(r,3e3)},600)}function o(){e.stickMan.classList.remove("idle","running","panic","jumping","climbing","flip")}function s(){const t=Date.now();if(t-e.lastObstacleUpdate<500)return;e.lastObstacleUpdate=t,e.obstacles=[];const n=["header","nav","footer","article",".post",".card",".home-profile",".home-avatar",".single-title",".content",".page",".pagination",".post-footer",".post-nav","h1","h2","h3","img",".button"];n.forEach(t=>{const n=document.querySelectorAll(t);n.forEach(t=>{if(t.id==="stick-man"||t.closest("#stick-man"))return;const n=t.getBoundingClientRect();n.width>20&&n.height>20&&e.obstacles.push({element:t,left:n.left+window.scrollX,top:n.top+window.scrollY,right:n.right+window.scrollX,bottom:n.bottom+window.scrollY,width:n.width,height:n.height,centerX:n.left+n.width/2,centerY:n.top+n.height/2})})})}function h(t,n,s=25){const o={left:t-s,top:n-s,right:t+50+s,bottom:n+80+s,centerX:t+25,centerY:n+40};for(let t of e.obstacles)if(o.right>t.left&&o.left<t.right&&o.bottom>t.top&&o.top<t.bottom)return t;return null}function c(t,n,s,o,i=150){let a=null,r=i;for(let i of e.obstacles){const c=i.centerX-(t+25),l=i.centerY-(n+40),d=(c*c+l*l)**.5;if(d<r){const e=(c*s+l*o)/d;e>.3&&(a=i,r=d)}}return a}function f(t){const n=Date.now();return!(n-e.lastJumpTime<e.jumpCooldown)&&!!t&&t.height<100&&t.height>30}function p(e){return!!e&&e.height>=100&&e.height<400}function g(){if(e.isJumping||e.isClimbing)return;e.isJumping=!0,e.jumpStartY=e.stickManY,e.lastJumpTime=Date.now(),n(t.JUMPING)}function v(s){if(e.isJumping||e.isClimbing)return;if(!s)return;e.isClimbing=!0,e.climbTarget=s,e.climbProgress=0,n(t.CLIMBING)}function n(n){if(e.state===n)return;const s=Date.now();if(s-e.stateChangeTime<e.minStateTime)return;switch(o(),e.state=n,e.stateChangeTime=s,n){case t.IDLE:e.stickMan.classList.add("idle");break;case t.RUNNING:e.stickMan.classList.add("running");break;case t.PANIC:e.stickMan.classList.add("panic","running");break;case t.JUMPING:e.stickMan.classList.add("jumping");break;case t.CLIMBING:e.stickMan.classList.add("climbing");break}}function j(){const a=e.stickManX+25-e.mouseX,r=e.stickManY+40-e.mouseY,s=(a*a+r*r)**.5,o=s<e.panicDistance,i=o?e.panicSpeed:e.speed;if(!e.isJumping&&!e.isClimbing&&(o&&e.state!==t.PANIC?n(t.PANIC):!o&&e.state===t.PANIC&&n(t.RUNNING)),e.isJumping){const i=500,a=Date.now()-e.lastJumpTime,s=Math.min(a/i,1);if(s>=1)e.isJumping=!1,n(o?t.PANIC:t.RUNNING);else{const n=80,t=s,o=-4*n*(t*t-t);e.stickManY=e.jumpStartY-o}}if(e.isClimbing&&e.climbTarget)if(e.climbProgress+=.015,e.climbProgress>=1)e.isClimbing=!1,e.stickManY=e.climbTarget.top-85,e.climbTarget=null,n(o?t.PANIC:t.RUNNING);else{const t=e.climbTarget.bottom,n=e.climbTarget.top-85;e.stickManY=t+(n-t)*b.easeInOutQuad(e.climbProgress);const s=a>0?e.climbTarget.right:e.climbTarget.left-50;e.stickManX+=(s-e.stickManX)*.1}if(!e.isJumping&&!e.isClimbing){if(s>0){const n=a/s,o=r/s;e.velocityX+=n*.8,e.velocityY+=o*.8,e.velocityX*=.85,e.velocityY*=.85;const t=(e.velocityX*e.velocityX+e.velocityY*e.velocityY)**.5;t>i&&(e.velocityX=e.velocityX/t*i,e.velocityY=e.velocityY/t*i)}let t=e.stickManX+e.velocityX,n=e.stickManY+e.velocityY;const u={x:e.velocityX/Math.max(Math.abs(e.velocityX),.1),y:e.velocityY/Math.max(Math.abs(e.velocityY),.1)},o=c(e.stickManX,e.stickManY,u.x,u.y,s<e.jumpDistance?100:150);o&&s<e.jumpDistance&&(f(o)?g():p(o)&&v(o));const d=h(t,n);if(d){const s=e.stickManX+25-d.centerX,o=e.stickManY+40-d.centerY,a=(s*s+o*o)**.5;a>0&&(e.velocityX=s/a*i*1.2,e.velocityY=o/a*i*1.2,t=e.stickManX+e.velocityX,n=e.stickManY+e.velocityY)}const l=20;t<l&&(t=l,e.velocityX=Math.abs(e.velocityX)*.8),t>window.innerWidth-70&&(t=window.innerWidth-70,e.velocityX=-Math.abs(e.velocityX)*.8),n<l&&(n=l,e.velocityY=Math.abs(e.velocityY)*.8),n>window.innerHeight-100&&(n=window.innerHeight-100,e.velocityY=-Math.abs(e.velocityY)*.8),e.stickManX=t,e.stickManY=n,e.velocityX<-.5?e.stickMan.classList.add("flip"):e.velocityX>.5&&e.stickMan.classList.remove("flip")}}function a(){if(!e.active)return;j(),e.stickMan.style.left=Math.round(e.stickManX)+"px",e.stickMan.style.top=Math.round(e.stickManY)+"px",e.animationFrame=requestAnimationFrame(a)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",i):i()})()